extrn GetStdHandle	:PROC
extrn ReadFile		:PROC
extrn WriteFile		:PROC
extrn ExitProcess	:PROC

.data
	sTextIn		db "String = ", 0h
	sTextOut	db "String Entered = ", 0h

.data?
	String		db 30 dup(?)
	nByte		db 0

.code
main proc
	mov		rbp, rsp
	sub		rsp, 38h							;Shadow Space(20) + Align (8) + (2b = 10)Local Variable

	mov		rcx, -10							;STD_INPUT_HANDLE
	call	GetStdHandle						
	mov		[rbp - 08h], rax					;Return hINPUT from RAX to [rbp-08h] = local variable
	mov		rcx, -11							;STD_OUTPUT_HANDLE
	call	GetStdHandle
	mov		[rbp - 10h], rax					;Return hOUTPUT from RAX to [rbp-08h] = local variable

	xor		rbx, rbx

	;Write sTextIn 
	mov		rcx, [rbp - 10h]					;hOUTPUT
	mov		rdx, offset sTextIn
	mov		r8, sizeof sTextIn
	mov		r9, offset nByte					;Return Value Agrument
	mov		[rsp + 20h], rbx					;Overlap
	call	WriteFile							;WriteFile(hOut, &String, size, &nByte, NULL)

	;Read String				
	mov		rcx, [rbp - 08h]					;hINPUT
	mov		rdx, offset String 
	mov		r8, 30
	mov		r9, offset nByte
	mov		[rsp + 20h], rbx
	call	ReadFile							;ReadFile(hIn, &String, size, &nByte, NULL)

	;Write sTextOut
	mov		rcx, [rbp - 10h]
	mov		rdx, offset sTextOut
	mov		r8, sizeof sTextOut
	mov		r9, offset nByte
	mov		[rsp + 20h], rbx
	call	WriteFile

	;Write String
	mov		rcx, [rbp - 10h]
	mov		rdx, offset String 
	mov		r8, sizeof String
	mov		r9, offset nByte
	mov		[rsp + 20h], rbx
	call	WriteFile
	
	xor		rcx, rcx
	call	ExitProcess

main endp
end